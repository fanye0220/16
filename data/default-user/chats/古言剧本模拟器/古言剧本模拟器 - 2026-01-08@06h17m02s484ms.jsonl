{"chat_metadata":{"integrity":"f718a537-4d82-40e4-996c-c19966bcbcc3"},"user_name":"unused","character_name":"unused"}
{"name":"古言剧本模拟器","is_user":false,"is_system":false,"send_date":"2026-01-07T22:18:32.922Z","mes":"```html\r\n<!DOCTYPE html>\r\n<html lang=\"zh-CN\">\r\n<head>\r\n<meta charset=\"UTF-8\">\r\n<style>\r\n    @import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap');\r\n\r\n    /* 全局变量与容器 */\r\n    .ancient-panel-root {\r\n        --main-color: #ACBECA;\r\n        --sub-color: #1E539F;\r\n        --accent-color: #E87B5E;\r\n        --other-color: #F4BD2F;\r\n        --text-color: #4B555E;\r\n\r\n        font-family: 'Noto Serif SC', serif;\r\n        color: var(--text-color);\r\n        width: 100%;\r\n        height: 650px;\r\n        position: relative;\r\n        overflow: hidden;\r\n        border-radius: 12px;\r\n        box-shadow: 0 4px 20px rgba(0,0,0,0.3);\r\n        background-color: #f0f0f0;\r\n    }\r\n\r\n    /* 通用隐藏类 */\r\n    .hidden { display: none !important; opacity: 0; pointer-events: none; }\r\n    .fade-out { opacity: 0 !important; transition: opacity 1s ease; }\r\n    .fade-in { opacity: 1 !important; transition: opacity 1s ease; }\r\n\r\n    /* ================= 界面一：封面 ================= */\r\n    .scene-cover {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        top: 0; left: 0;\r\n        background: url('https://cdncs.ykt.cbern.com.cn/v0.1/download?path=/zxx_feedback/qdqqd/1767578816912.png') no-repeat center center;\r\n        background-size: cover;\r\n        z-index: 10;\r\n        transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1), filter 1.5s ease;\r\n        overflow: hidden; /* 防止放大后的图片溢出 */\r\n    }\r\n\r\n    /* 飘动素材1 - 核心修改点 */\r\n    .floating-obj-1 {\r\n        position: absolute;\r\n        /* 调整位置，使其更具视觉冲击力 */\r\n        top: -20%;\r\n        right: -30%;\r\n        /* 放大图片 */\r\n        width: 150%;\r\n        opacity: 0.9;\r\n        /* 应用更大幅度的动画 */\r\n        animation: float-large 10s infinite alternate ease-in-out;\r\n        pointer-events: none;\r\n    }\r\n    /* 定义更大幅度的漂浮动画 */\r\n    @keyframes float-large {\r\n        0% { transform: translate(0, 0) rotate(0deg) scale(1); }\r\n        100% { transform: translate(-50px, 40px) rotate(5deg) scale(1.05); }\r\n    }\r\n\r\n    /* 蝴蝶 */\r\n    .butterfly {\r\n        position: absolute;\r\n        width: 40px;\r\n        top: 60%; left: 10%;\r\n        cursor: pointer;\r\n        z-index: 12;\r\n        animation: butterfly-fly 5s ease-out forwards;\r\n    }\r\n    @keyframes butterfly-fly {\r\n        0% { top: 80%; left: -10%; transform: scale(0.5) rotate(15deg); }\r\n        50% { top: 40%; left: 40%; transform: scale(0.8) rotate(-10deg); }\r\n        100% { top: 20%; right: 25%; transform: scale(1) rotate(0deg); }\r\n    }\r\n    .butterfly:hover { filter: brightness(1.2); transform: scale(1.1); }\r\n\r\n    /* 扇子 */\r\n    .fan-trigger {\r\n        position: absolute;\r\n        top: 50%; left: 50%;\r\n        transform: translate(-50%, -50%) scale(0.8);\r\n        width: 200px;\r\n        opacity: 0;\r\n        cursor: pointer;\r\n        transition: all 0.8s ease;\r\n        z-index: 11;\r\n        filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2));\r\n    }\r\n    .fan-visible { opacity: 1; transform: translate(-50%, -50%) scale(1); }\r\n    .fan-trigger:hover { transform: translate(-50%, -50%) scale(1.05) rotate(5deg); }\r\n\r\n    /* ================= 界面二：功能区 ================= */\r\n    .scene-main {\r\n        width: 100%;\r\n        height: 100%;\r\n        position: absolute;\r\n        top: 0; left: 0;\r\n        background: url('https://static.eeo.cn/upload/images/20260105/0b2b822b07ebbcd57778.png') no-repeat center center;\r\n        background-size: cover;\r\n        z-index: 5;\r\n        opacity: 0;\r\n        transition: opacity 1.5s ease;\r\n        overflow-y: auto;\r\n        padding-bottom: 60px;\r\n    }\r\n    .scene-main::-webkit-scrollbar { width: 6px; }\r\n    .scene-main::-webkit-scrollbar-thumb { background: var(--sub-color); border-radius: 3px; }\r\n\r\n    /* 飘动素材3 */\r\n    .floating-obj-3 {\r\n        position: fixed;\r\n        top: 0; left: 0;\r\n        width: 100%; height: 100%;\r\n        background: url('https://xiaoiwg.dongfeng-nissan.com.cn/aicc-workbench/res/download/default/temp/images/20260105/a98f18b06b89c2689a5ae2460798b31fa3f465ef.png') no-repeat top left;\r\n        background-size: contain;\r\n        opacity: 0.6;\r\n        pointer-events: none;\r\n        animation: float-bg 15s infinite linear;\r\n        z-index: 0;\r\n    }\r\n    @keyframes float-bg {\r\n        0% { transform: translateX(-5%) translateY(-5%); }\r\n        50% { transform: translateX(0) translateY(0); }\r\n        100% { transform: translateX(-5%) translateY(-5%); }\r\n    }\r\n\r\n    /* 内容容器 */\r\n    .content-wrapper {\r\n        position: relative;\r\n        z-index: 2;\r\n        padding: 20px;\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 35px;\r\n        align-items: center;\r\n    }\r\n\r\n    /* 版块标题 */\r\n    .section-title {\r\n        font-size: 1.2em;\r\n        color: var(--sub-color);\r\n        border-bottom: 2px solid var(--accent-color);\r\n        padding-bottom: 5px;\r\n        margin-bottom: 15px;\r\n        width: 100%;\r\n        text-align: center;\r\n        font-weight: bold;\r\n    }\r\n\r\n    /* --- 转盘样式 --- */\r\n    .wheel-container {\r\n        position: relative;\r\n        width: 280px;\r\n        height: 280px;\r\n        margin: 20px auto;\r\n    }\r\n    .wheel {\r\n        width: 100%; height: 100%;\r\n        border-radius: 50%;\r\n        border: 8px solid var(--main-color);\r\n        background: radial-gradient(circle, #fff 40%, var(--main-color) 100%);\r\n        position: relative;\r\n        overflow: hidden;\r\n        transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);\r\n        box-shadow: inset 0 0 20px rgba(0,0,0,0.1);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n    .wheel::after {\r\n        content: ''; position: absolute; top:0; left:0; right:0; bottom:0;\r\n        background: repeating-conic-gradient(from 0deg, transparent 0deg 30deg, rgba(232, 123, 94, 0.1) 30deg 32deg);\r\n        border-radius: 50%;\r\n    }\r\n    .wheel-text {\r\n        font-size: 1.4em;\r\n        color: var(--sub-color);\r\n        font-weight: bold;\r\n        text-align: center;\r\n        padding: 10px 30px;\r\n        z-index: 2;\r\n        transform: translateY(-25px);\r\n        line-height: 1.3;\r\n    }\r\n    .wheel-btn {\r\n        position: absolute;\r\n        top: 50%; left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        width: 50px; height: 50px;\r\n        background: var(--accent-color);\r\n        border-radius: 50%;\r\n        border: 3px solid #fff;\r\n        color: #fff;\r\n        display: flex; align-items: center; justify-content: center;\r\n        font-weight: bold;\r\n        cursor: pointer;\r\n        z-index: 10;\r\n        box-shadow: 0 4px 10px rgba(0,0,0,0.3);\r\n        transition: transform 0.2s;\r\n        margin-top: 30px;\r\n    }\r\n    .wheel-btn:active { transform: translate(-50%, -50%) scale(0.95); margin-top: 30px; }\r\n    .wheel-arrow {\r\n        position: absolute;\r\n        top: -15px; left: 50%;\r\n        transform: translateX(-50%);\r\n        width: 0; height: 0;\r\n        border-left: 15px solid transparent;\r\n        border-right: 15px solid transparent;\r\n        border-top: 25px solid var(--accent-color);\r\n        z-index: 5;\r\n    }\r\n\r\n    /* 自定义输入框 */\r\n    .custom-input {\r\n        width: 80%;\r\n        padding: 8px;\r\n        border: 1px solid var(--main-color);\r\n        border-radius: 4px;\r\n        background: rgba(255,255,255,0.8);\r\n        font-family: inherit;\r\n        color: var(--text-color);\r\n        outline: none;\r\n        margin-top: 10px;\r\n        text-align: center;\r\n    }\r\n    .custom-input:focus { border-color: var(--sub-color); }\r\n\r\n    /* --- 选择题样式 --- */\r\n    .options-grid {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        gap: 10px;\r\n        justify-content: center;\r\n    }\r\n    .option-tag {\r\n        padding: 6px 15px;\r\n        background: rgba(255,255,255,0.6);\r\n        border: 1px solid var(--main-color);\r\n        border-radius: 20px;\r\n        cursor: pointer;\r\n        transition: all 0.3s;\r\n        font-size: 0.9em;\r\n    }\r\n    .option-tag:hover { background: rgba(172, 190, 202, 0.3); }\r\n    .option-tag.selected {\r\n        background: var(--sub-color);\r\n        color: #fff;\r\n        border-color: var(--sub-color);\r\n        box-shadow: 0 2px 8px rgba(30, 83, 159, 0.3);\r\n    }\r\n\r\n    /* --- 结局抽取 --- */\r\n    .ending-box {\r\n        width: 90%;\r\n        min-height: 80px;\r\n        border: 2px dashed var(--other-color);\r\n        background: rgba(244, 189, 47, 0.1);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        text-align: center;\r\n        padding: 15px;\r\n        border-radius: 8px;\r\n        font-size: 1.1em;\r\n        color: var(--text-color);\r\n        cursor: pointer;\r\n        transition: all 0.3s;\r\n        margin-bottom: 10px;\r\n    }\r\n    .ending-box:hover { background: rgba(244, 189, 47, 0.2); }\r\n\r\n    /* --- 补充信息 --- */\r\n    .supplement-area {\r\n        width: 90%;\r\n        height: 80px;\r\n        padding: 10px;\r\n        border: 1px solid var(--main-color);\r\n        border-radius: 4px;\r\n        background: rgba(255,255,255,0.7);\r\n        font-family: inherit;\r\n        resize: none;\r\n    }\r\n\r\n    /* --- 提交按钮 (指纹) --- */\r\n    .submit-fingerprint {\r\n        width: 60px;\r\n        height: 60px;\r\n        background: url('https://cdn.jsdelivr.net.cn/gh/xxloli/tc/zxsmfb84rl.png') no-repeat center center;\r\n        background-size: contain;\r\n        cursor: pointer;\r\n        transition: transform 0.3s, filter 0.3s;\r\n        margin-top: 20px;\r\n    }\r\n    .submit-fingerprint:hover { transform: scale(1.1); filter: drop-shadow(0 0 5px var(--accent-color)); }\r\n    .submit-fingerprint:active { transform: scale(0.95); }\r\n\r\n    /* --- 加载进度条 --- */\r\n    .loading-overlay {\r\n        position: absolute;\r\n        top: 0; left: 0; width: 100%; height: 100%;\r\n        background: #fff;\r\n        z-index: 20;\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n        justify-content: center;\r\n        opacity: 0;\r\n        pointer-events: none;\r\n        transition: opacity 0.5s;\r\n        overflow: hidden;\r\n    }\r\n    .loading-overlay.active { opacity: 1; pointer-events: auto; }\r\n\r\n    /* 大背景移动动画 */\r\n    .loading-bg-move {\r\n        position: absolute;\r\n        top: 0; left: 0;\r\n        width: 200%;\r\n        height: 100%;\r\n        background: url('https://static.eeo.cn/upload/file/20260105/1767581069760382.png') repeat-x center center;\r\n        background-size: contain;\r\n        opacity: 0.5;\r\n        animation: bg-scroll 10s linear infinite;\r\n        z-index: 1;\r\n    }\r\n    @keyframes bg-scroll {\r\n        0% { transform: translateX(0); }\r\n        100% { transform: translateX(-50%); }\r\n    }\r\n\r\n    .progress-bar-container {\r\n        width: 80%;\r\n        height: 6px;\r\n        background: #ddd;\r\n        border-radius: 3px;\r\n        position: relative;\r\n        overflow: visible;\r\n        z-index: 5;\r\n    }\r\n    .progress-bar {\r\n        width: 0%;\r\n        height: 100%;\r\n        background: var(--accent-color);\r\n        border-radius: 3px;\r\n        transition: width 3s linear;\r\n    }\r\n    .loading-text {\r\n        margin-top: 15px;\r\n        color: var(--accent-color);\r\n        font-size: 1em;\r\n        z-index: 5;\r\n        font-weight: bold;\r\n    }\r\n\r\n</style>\r\n</head>\r\n<body>\r\n\r\n<div class=\"ancient-panel-root\">\r\n\r\n    <!-- 界面一：封面 -->\r\n    <div class=\"scene-cover\" id=\"sceneCover\">\r\n        <!-- 放大并漂浮的素材 -->\r\n        <img src=\"https://static.eeo.cn/upload/file/20260105/1767578865381696.png\" class=\"floating-obj-1\">\r\n        <img src=\"https://s3plus.meituan.net/opapisdk/op_ticket_1_885190757_1767579132159_qdqqd_egbqhg.png\" class=\"butterfly\" onclick=\"showFan()\">\r\n        <img src=\"https://saas.chatbot.cn/download/minio/standard/2026-01-05/2be96cb8acf74425b7e0b506f7498610.png\" class=\"fan-trigger\" id=\"fanTrigger\" onclick=\"switchScene()\">\r\n    </div>\r\n\r\n    <!-- 界面二：功能区 -->\r\n    <div class=\"scene-main\" id=\"sceneMain\">\r\n        <div class=\"floating-obj-3\"></div>\r\n\r\n        <div class=\"content-wrapper\">\r\n\r\n            <!-- 1. User 身份 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 卿之身份 ✧</div>\r\n                <div class=\"wheel-container\">\r\n                    <div class=\"wheel-arrow\"></div>\r\n                    <div class=\"wheel\" id=\"wheelUser\">\r\n                        <div class=\"wheel-text\" id=\"resUser\">点击抽取</div>\r\n                    </div>\r\n                    <div class=\"wheel-btn\" onclick=\"spinWheel('User')\">启</div>\r\n                </div>\r\n                <input type=\"text\" class=\"custom-input\" id=\"inputUser\" placeholder=\"或在此自定义身份...\">\r\n            </div>\r\n\r\n            <!-- 2. Char 身份 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 君之身份 ✧</div>\r\n                <div class=\"wheel-container\">\r\n                    <div class=\"wheel-arrow\"></div>\r\n                    <div class=\"wheel\" id=\"wheelChar\">\r\n                        <div class=\"wheel-text\" id=\"resChar\">点击抽取</div>\r\n                    </div>\r\n                    <div class=\"wheel-btn\" onclick=\"spinWheel('Char')\">启</div>\r\n                </div>\r\n                <input type=\"text\" class=\"custom-input\" id=\"inputChar\" placeholder=\"或在此自定义身份...\">\r\n            </div>\r\n\r\n            <!-- 3. 剧情风格 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 剧本风华 ✧</div>\r\n                <div class=\"options-grid\" id=\"styleOptions\">\r\n                    <!-- JS生成选项 -->\r\n                </div>\r\n            </div>\r\n\r\n            <!-- 4. 情感侧重 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 情之所系 ✧</div>\r\n                <div class=\"options-grid\" id=\"emotionOptions\">\r\n                    <!-- JS生成选项 -->\r\n                </div>\r\n            </div>\r\n\r\n            <!-- 5. 结局抽取 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 命定终章 ✧</div>\r\n                <div class=\"ending-box\" id=\"endingBox\" onclick=\"drawEnding()\">\r\n                    点击此处，以此指纹定终身\r\n                </div>\r\n                <!-- 自定义结局 -->\r\n                <input type=\"text\" class=\"custom-input\" id=\"inputEnding\" placeholder=\"若命不由天，请在此手书终章...\">\r\n            </div>\r\n\r\n            <!-- 6. 补充信息 -->\r\n            <div style=\"width:100%; text-align:center;\">\r\n                <div class=\"section-title\">✧ 细枝末节 ✧</div>\r\n                <textarea class=\"supplement-area\" id=\"supplementInput\" placeholder=\"家族势力、兄弟姐妹或其他补充设定...\"></textarea>\r\n            </div>\r\n\r\n            <!-- 提交 -->\r\n            <div class=\"submit-fingerprint\" onclick=\"submitAll()\"></div>\r\n\r\n        </div>\r\n    </div>\r\n\r\n    <!-- 加载层 -->\r\n    <div class=\"loading-overlay\" id=\"loadingOverlay\">\r\n        <!-- 动态背景层 -->\r\n        <div class=\"loading-bg-move\"></div>\r\n\r\n        <div class=\"progress-bar-container\">\r\n            <div class=\"progress-bar\" id=\"progressBar\"></div>\r\n        </div>\r\n        <div class=\"loading-text\">正在编织命运...</div>\r\n    </div>\r\n\r\n</div>\r\n\r\n<script>\r\n    // 数据源\r\n    const userIdentities = \"意气风发女将军 渴望自由女杀手 傲气娇纵富家千金 天真浪漫世家二小姐 温柔贤淑书香小姐 古灵精怪王府郡主 明艳动京城头牌花魁 自由热烈江湖侠女 野心勃勃皇室帝姬 清冷孤傲世家嫡女 温婉隐忍侯府姨娘 飒爽利落边关女哨 玲珑通透商贾之女 坚韧倔强罪臣之女 娇憨软萌乡野村姑 清冷绝尘修道女仙 聪慧机敏宫廷女官 泼辣干练镖局少东家 端庄大气皇后继妹 柔情似水江南绣娘 清冷孤傲乐坊琴师 桀骜不驯山寨女匪 恬静淡然书香闺秀 果敢决绝复仇孤女 娇俏灵动尚书庶女 端庄自持名门贵女 动俏皮戏班花旦 英气飒爽女扮男装 温婉贤淑世家主母 狠戾果决深宫贵妃 清新脱俗山间医女 活泼明媚梨园名角 隐忍坚韧亡国公主 聪慧狡黠钱庄少奶奶 孤傲冷艳江湖毒医 温柔体贴贴身侍女 娇蛮任性长公主 沉稳干练漕帮女舵主 清丽脱俗书院女先生 泼辣直爽市井老板娘 柔中带刚和亲公主 清冷孤傲剑客之女 天真烂漫乡绅之女 聪慧过人算学才女 桀骜不驯将门庶女 温婉可人王府侧妃 果敢勇猛女捕快 清冷绝俗画坊娘子 灵动娇俏酒肆老板娘 坚韧不拔寒门才女 娇憨可爱王府小郡主 狠辣果决江湖妖女 温柔娴静太傅之女 英气逼人女护卫 玲珑剔透宫廷才人 泼辣豪爽边关军嫂 恬静淡雅茶坊掌柜 孤傲决绝灭门孤女 娇俏明艳青楼红牌 聪慧沉稳盐商之女 温婉贤淑秀才娘子 桀骜不驯草原郡主 清冷孤傲道观道姑 灵动活泼戏班小旦 果敢坚毅守城女将 娇蛮任性富商嫡女 温柔善良药铺医女 孤傲冷艳江湖孤女 聪慧机敏县令之女 泼辣干练织坊主母 恬静淡然隐士之女 桀骜不驯海盗女王 温婉可人王府庶女 果敢勇猛江湖侠盗 清冷绝俗琴棋才女 灵动娇俏客栈老板娘 坚韧不拔流民之女 娇憨可爱乡野丫头 狠辣果决深宫昭仪 温柔娴静御史之女 英气逼人女扮男装公子 玲珑剔透账房先生 泼辣豪爽酒坊老板娘 恬静淡雅书院山长之女 孤傲决绝复仇女侠 娇俏明艳戏楼台柱 聪慧沉稳粮商之女 温婉贤淑举人娘子 桀骜不驯西域圣女 清冷孤傲古墓传人 灵动活泼镖局千金 果敢坚毅女镖师 娇蛮任性郡主之女 温柔善良绣坊绣娘\".split(' ');\r\n\r\n    const charIdentities = \"不近女色清冷王爷 被人冷落世家庶子 饱读诗书温润公子 鲜衣怒马少年将军 温润和煦世家公子 生动张扬少年将军 吊儿郎当受宠皇子 心机深沉病娇王爷 扮猪吃虎侯府纨绔 冷酷杀伐铁血帝王 温润如玉当朝太子 浪迹天涯江湖剑客 隐忍腹黑丞相之子 风流倜傥江南才子 沉默寡言边关副将 玩世不恭世家世子 温润儒雅书院先生 狠戾果决江湖盟主 温润如玉太医圣手 桀骜不驯草原王子 隐忍内敛侯府世子 风流不羁花间浪子 沉稳睿智当朝太傅 冷冽孤傲江湖刀客 温润谦和科举状元 玩世不恭富家少爷 狠戾果决东厂厂公 温润如玉世家公子 桀骜不驯海盗头领 隐忍内敛冷宫皇子 风流不羁酒馆老板 沉稳睿智军机大臣 冷冽孤傲雪山剑客 温润谦和私塾先生 玩世不恭戏班班主 狠戾果决江湖杀手 温润如玉江南富商 桀骜不驯西域王子 隐忍内敛将军副将 风流不羁茶楼掌柜 沉稳睿智县令大人 冷冽孤傲古墓剑客 温润谦和秀才相公 玩世不恭盐商少爷 狠戾果决山寨头领 温润如玉镖局总镖头 桀骜不驯边关校尉 隐忍内敛丞相庶子 风流不羁梨园名角 沉稳睿智尚书大人 冷冽孤傲江湖侠士 温润谦和举人老爷 玩世不恭粮商公子 狠戾果决锦衣卫指挥使 温润如玉药铺掌柜 桀骜不驯江湖浪子 隐忍内敛王府庶子 风流不羁客栈老板 沉稳睿智巡抚大人 冷冽孤傲剑客传人 温润谦和织坊老板 玩世不恭漕帮少帮主 狠戾果决江湖毒师 温润如玉书生相公 桀骜不驯草原勇士 隐忍内敛皇宫侍卫 风流不羁酒坊掌柜 沉稳睿智知府大人 冷冽孤傲江湖孤客 温润谦和账房先生 玩世不恭侯府公子 狠戾果决江湖枭雄 温润如玉琴师相公 桀骜不驯西域侠客 隐忍内敛世家旁支 风流不羁茶楼公子 沉稳睿智总兵大人 冷冽孤傲道观道士 温润谦和画坊掌柜 玩世不恭富商公子 狠戾果决江湖盟主之子 温润如玉秀才公子 桀骜不驯边关将领 隐忍内敛太傅庶子 风流不羁戏楼公子 沉稳睿智户部尚书 冷冽孤傲江湖刀客传人 温润谦和药铺郎中 玩世不恭镖局少爷 狠戾果决江湖杀手头领\".split(' ');\r\n\r\n    const endings = \"家族联姻先婚后爱 宿敌结缘相爱相杀 一见钟情再见倾心 强取豪夺难开心扉 家族仇恨虐恋情深 江湖偶遇相知相守 宫廷相逢步步惊心 乡野初遇日久生情 书院同窗暗生情愫 边关相守共御外敌 深宫争斗彼此守护 江湖追杀患难与共 世家恩怨爱恨纠缠 商海沉浮携手并肩 梨园相逢情根深种 道观偶遇一眼万年 酒肆初遇欢喜冤家 镖局同行情愫渐生 绣坊相逢情意绵绵 战场重逢再续前缘 冷宫相守不离不弃 山寨结缘爱恨难休 茶坊初遇温柔以待 织坊相逢情投意合 盐商同行风雨同舟 粮商相遇冷暖与共 古墓相逢宿命纠缠 西域相逢一见倾心 草原相遇策马同行 漕帮共事暗生情意 东厂交锋爱恨交织 锦衣卫相遇步步为营 太医问诊情根深种 状元游街惊鸿一瞥 县令断案情愫暗生 巡抚巡查一见如故 总兵驻守相守相伴 太傅授课日久生情 尚书议事情投意合 侍卫护主日久情深 杀手相遇生死相随 侠客相逢快意恩仇 毒师偶遇爱恨难明 琴师相逢以乐传情 书生相遇以文相知 戏子相逢情牵一生 将军出征夫人相送 王爷赴任王妃随行 庶子逆袭携手同行 纨绔悔改相守一生 城楼下他万箭穿心她以身殉情 她只是他权谋路上一枚弃子 他另娶良人她饮毒含笑而终 她奉旨和亲他驻守边关终身未娶 她被敌军凌辱至死他服毒相随 二人携手归隐山林安稳度余生 深宫争斗她惨死冷宫他孤独终老 江湖追杀二人同归于尽血染山河 家族恩怨化解二人相守岁岁年年 商海落败二人变卖田产归隐田园 他登基为帝她封后相守一生一世 他战死沙场她终身不嫁青灯古佛 她病逝榻前他余生未再沾染情爱 二人反目成仇刀剑相向同归于尽 她恢复记忆弃他而去浪迹天涯 他毒发身亡她携尸归隐永不入世 她为救他挡剑而死他终身守墓 他为护她谋反被杀她殉情自缢 二人识破阴谋携手匡扶社稷安邦 她远走他乡他寻遍天下终得相见 他被陷害流放她弃家相随不离不弃 她沦为官妓他散尽家财为她赎身相守 他入赘她家二人琴瑟和鸣儿女双全 她嫁他人为妻他终身不娶孤独终老 二人携手闯荡江湖逍遥一生无牵挂 她难产而死他终身未再续弦守着儿女 他被赐毒酒她陪他共饮黄泉相伴 她被赐和亲他半路劫亲双双亡命天涯 二人隐居乡野男耕女织安稳度日 他双目失明她不离不弃悉心照料 她容颜尽毁他深情不改相守如初 家族覆灭二人相依为命共渡余生 他金榜题名娶她为妻风光无限 她救他性命二人暗生情愫相守一生 他江湖扬名娶她为妻快意恩仇 深宫夺权成功二人君临天下相守 她被诬陷赐死他查明真相为她报仇后殉情 他浪迹天涯她苦苦等候终得团圆 她行医救人他随行相伴走遍山河 他戏班扬名她相伴左右情意绵绵 二人遭人暗算同赴黄泉永不分离 她为家族牺牲自己他终身悔恨孤独终老 他为救她身中剧毒她耗尽修为相伴余生 二人看破红尘携手归隐道观共度余生 她经商致富他弃官相随相守一生 他边关建功立业她在家中等候荣归故里 她为他洗手作羹汤他为她弃剑归田 二人恩怨难解此生相望不相守 他另娶她人她心死远走终身未归\".split(' ');\r\n\r\n    const styles = [\"宅斗权谋\", \"轻松种田\", \"江湖快意\", \"古风正剧\", \"深情虐恋\", \"宫廷争斗\", \"市井烟火\"];\r\n    const emotions = [\"亲情主导\", \"爱情主线\", \"友情至上\", \"无侧重(多线并行)\"];\r\n\r\n    // 初始化选项\r\n    function initOptions() {\r\n        const styleContainer = document.getElementById('styleOptions');\r\n        styles.forEach(s => {\r\n            let div = document.createElement('div');\r\n            div.className = 'option-tag';\r\n            div.innerText = s;\r\n            div.onclick = function() {\r\n                // 单选逻辑\r\n                Array.from(styleContainer.children).forEach(c=>c.classList.remove('selected'));\r\n                this.classList.add('selected');\r\n            };\r\n            styleContainer.appendChild(div);\r\n        });\r\n\r\n        const emoContainer = document.getElementById('emotionOptions');\r\n        emotions.forEach(e => {\r\n            let div = document.createElement('div');\r\n            div.className = 'option-tag';\r\n            div.innerText = e;\r\n            div.onclick = function() {\r\n                Array.from(emoContainer.children).forEach(c=>c.classList.remove('selected'));\r\n                this.classList.add('selected');\r\n            };\r\n            emoContainer.appendChild(div);\r\n        });\r\n    }\r\n    initOptions();\r\n\r\n    // 交互逻辑\r\n    function showFan() {\r\n        document.getElementById('fanTrigger').classList.add('fan-visible');\r\n    }\r\n\r\n    function switchScene() {\r\n        const cover = document.getElementById('sceneCover');\r\n        const main = document.getElementById('sceneMain');\r\n\r\n        // 水墨感淡出：利用filter blur和opacity\r\n        cover.style.filter = 'blur(10px) grayscale(100%)';\r\n        cover.style.opacity = '0';\r\n\r\n        setTimeout(() => {\r\n            cover.classList.add('hidden');\r\n            main.style.opacity = '1';\r\n        }, 1000);\r\n    }\r\n\r\n    function spinWheel(type) {\r\n        const wheel = document.getElementById('wheel' + type);\r\n        const resText = document.getElementById('res' + type);\r\n        const list = type === 'User' ? userIdentities : charIdentities;\r\n\r\n        // 旋转动画\r\n        let rot = Math.floor(Math.random() * 360) + 720; // 至少转2圈\r\n        wheel.style.transform = `rotate(${rot}deg)`;\r\n\r\n        // 模拟结果\r\n        setTimeout(() => {\r\n            const item = list[Math.floor(Math.random() * list.length)];\r\n            resText.innerText = item;\r\n            // 修正角度以便下次旋转\r\n            wheel.style.transition = 'none';\r\n            wheel.style.transform = 'rotate(0deg)';\r\n            setTimeout(() => wheel.style.transition = 'transform 4s cubic-bezier(0.2, 0.8, 0.3, 1)', 50);\r\n        }, 4000);\r\n    }\r\n\r\n    function drawEnding() {\r\n        const box = document.getElementById('endingBox');\r\n        box.innerText = \"命运流转中...\";\r\n        setTimeout(() => {\r\n            const end = endings[Math.floor(Math.random() * endings.length)];\r\n            box.innerText = end;\r\n            box.style.borderStyle = 'solid';\r\n            box.style.borderColor = '#E87B5E';\r\n            box.style.background = 'rgba(232, 123, 94, 0.1)';\r\n        }, 800);\r\n    }\r\n\r\n    function submitAll() {\r\n        // 获取数据\r\n        const userRes = document.getElementById('inputUser').value || document.getElementById('resUser').innerText;\r\n        const charRes = document.getElementById('inputChar').value || document.getElementById('resChar').innerText;\r\n        const styleEl = document.querySelector('#styleOptions .selected');\r\n        const emoEl = document.querySelector('#emotionOptions .selected');\r\n        // 优先获取自定义结局\r\n        const endRes = document.getElementById('inputEnding').value || document.getElementById('endingBox').innerText;\r\n        const supp = document.getElementById('supplementInput').value;\r\n\r\n        if (userRes === '点击抽取' || charRes === '点击抽取' || !styleEl || !emoEl || endRes.includes('点击')) {\r\n            alert('请完善所有命运抉择（抽取身份、选择风格情感、抽取结局）');\r\n            return;\r\n        }\r\n\r\n        // 启动加载动画\r\n        const overlay = document.getElementById('loadingOverlay');\r\n        const bar = document.getElementById('progressBar');\r\n\r\n        overlay.classList.add('active');\r\n\r\n        // 动画过程\r\n        setTimeout(() => {\r\n            bar.style.width = '100%';\r\n        }, 100);\r\n\r\n        // 发送指令\r\n        setTimeout(() => {\r\n            const msg = `[系统生成]\r\nUser身份：${userRes}\r\nChar身份：${charRes}\r\n剧情风格：${styleEl.innerText}\r\n情感侧重：${emoEl.innerText}\r\n既定结局：${endRes}\r\n补充设定：${supp}\r\n请根据以上设定开始剧情。`;\r\n\r\n            if (typeof triggerSlash === 'function') {\r\n                triggerSlash(`/send ${msg} | /trigger`);\r\n            } else {\r\n                console.log(msg);\r\n            }\r\n        }, 3200);\r\n    }\r\n</script>\r\n\r\n</body>\r\n</html>\r\n```","extra":{}}